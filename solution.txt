LAB | SQL Joins

Challenge - Joining on multiple tables

1-List the number of films per category.

SELECT category_id, COUNT(*) AS number_of_films
FROM sakila.film_category
GROUP BY category_id;

2-Retrieve the store ID, city, and country for each store

SELECT store_id,city,country FROM sakila.store as s
JOIN sakila.address as ad
ON ad.address_id = s.address_id
JOIN sakila.city as ci
ON ci.city_id = ad.city_id
JOIN sakila.country as co
ON co.country_id = ci.country_id;

3-Calculate the total revenue generated by each store in dollars.

SELECT SUM(amount) FROM sakila.payment as p
JOIN sakila.staff as s
ON p.staff_id = s.staff_id
JOIN sakila.store as sto
ON s.store_id = sto.store_id
GROUP BY sto.store_id;

4-Determine the average running time of films for each category.

SELECT category_id,AVG(length) FROM sakila.film as f
JOIN sakila.film_category as fc
ON f.film_id = fc.film_id
GROUP BY category_id;

5-Identify the film categories with the longest average running time.

SELECT category_id,AVG(length) FROM sakila.film f
JOIN sakila.film_category as fc
ON f.film_id = fc.film_id
ORDER BY AVG(length) DESC
LIMIT 1;

6-Display the top 10 most frequently rented movies in descending order.

SELECT title, rental_rate from sakila.film
ORDER BY rental_rate DESC
LIMIT 10;


7-Determine if "Academy Dinosaur" can be rented from Store 1.

SELECT store_id,title
FROM sakila.film as f
INNER JOIN  sakila.inventory as i
ON f.film_id = i.film_id
WHERE f.title = 'Academy Dinosaur'
  AND i.store_id = 1;